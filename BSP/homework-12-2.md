# Домашнее задание к занятию «Программный интерфейс»

Концепция ДЗ
1. Реализация выполнения тяжёлой операции в фоне.
2. Рефакторинг существующего кода — поиск того, где можно вместо своей реализации использовать возможности программного интерфейса БСП.


### Цель задания

1. Научиться использовать программный интерфейс БСП для решения задач:
    - вывод сообщений,
    - получение текущего пользователя,
    - получение данных из базы,
    - выполнение длительных операций в фоне.

### Чеклист готовности к домашнему заданию

- [ ] Установить учебную платформу версии 8.3.22 или больше.
- [ ] Подготовить информационную базу, полученную по итогу выполнения [домашнего задания к занятию 12-1](homework-12-1.md).

## Инструкция к заданию

1. Скачайте [расширение с заданием](homework-12-2.cfe).
2. Установите в информационную базу.
3. Выполните задание в конфигураторе.
4. Протестируйте решение в пользовательском режиме.
5. В личном кабинете Нетологии отправьте на проверку один доработанный файл расширения (.cfe), содержащий решение по всем 2 задачам. Файл прикрепите в раздел «решение» в практическом задании.

### Задание 1. «Рефакторинг существующего кода»

### Описание задачи
Вам передали расширение предыдущего разработчика, который не использовал БСП в своей работе. Вы хотите максимально задействовать БСП в работе алгоритмов расширения.

### Требования к результату
В обработке «ДЗ_12_2_АлгоритмыДляРефакторинга» в командах «ПрочитатьКонтрагентаДоговор», «ПроверитьGUID», «СообщитьТекущегоПользователя» и «ОткрытьСайтНетологии» необходимо максимально заменить свой код на вызов методов из БСП, подходящих по смыслу.

### Процесс выполнения
1. Изучите алгоритм работы перечисленных команд.
2. Выделите участки алгоритмов, которые можно заменить на вызовы методов БСП.
3. Выполните замену.
4. Протестируйте корректность работы команд после замены.

### Результат задания
1. Запустите базу в пользовательском режиме.
2. Убедитесь, что команды работают так же, как и до рефакторинга.

### Задание 2. «Реализация выполнения тяжёлой операции в фоне»

### Описание задачи
Вы продолжаете рефакторить расширение и хотите вынести выполнение тяжёлой операции в фон.

### Требования к результату
В обработке «ДЗ_12_2_АлгоритмыДляРефакторинга» в команде «ВыполнитьТяжелуюОперацию» выполните запуск фонового задания, ожидание результата и последующего вывода результата пользователю. Для решения задачи необходимо использовать ДлительныеОперации БСП.

### Процесс выполнения
1. На сервере замените прямой вызов функции из модуля менеджера обработки на вызов `ДлительныеОперации.ВыполнитьФункцию` с передачей имени функции. Верните на клиент информацию о запущенной длительной операции.
2. На клиенте запустите ожидание длительной операции с помощью `ДлительныеОперацииКлиент.ОжидатьЗавершение`, передавая ОписаниеОповещения.
3. В методе, куда передаёт управление ОписаниеОповещения, получите результат работы из временного хранилища и выведите пользователю.

(ВАЖНО!) Саму функцию в модуле менеджера обработки менять нельзя. Она должна остаться в том же виде.

### Результат задания
1. Запустите базу в пользовательском режиме.
2. Убедитесь, что тяжёлая операция выполняется в фоне, на время выполнения открывается форма ожидания.

### Критерии оценки

1. Зачёт — выполнены все задания, в выполненных заданиях нет противоречий и нарушения логики. 
2. На доработку — задание выполнено частично или не выполнено, в логике выполнения заданий есть противоречия, существенные недостатки.

Все задачи обязательны к выполнению. Пожалуйста, присылайте на проверку все задачи сразу.

Любые вопросы по решению задач задавайте в чате учебной группы.

*Примерное время выполнения: 45–120 минут*
